{% extends "base.html" %}
{% block title %}Buscar Nome{% endblock %}

{% block content %}
<h1>Buscar Nome</h1>

<!-- Mensagens Flash -->
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <div class="mt-3">
      {% for category, message in messages %}
        <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}

<!-- Formulário -->
<form method="POST" class="mb-4">
  <div class="input-group">
    <input 
      type="text" 
      name="termo" 
      class="form-control" 
      placeholder="Digite pelo menos 3 letras..." 
      value="{{ termo_pesquisado }}" 
      minlength="3"
      required
    >
    <button class="btn btn-primary" type="submit">
      <i class="bi bi-search"></i> Buscar
    </button>
  </div>
  <small class="text-muted">Ex: "Joa" → João, Joana, Joaquim...</small>
</form>

<!-- Resultados -->
{% if resultados %}
<table class="table table-striped table-hover mt-3">
  <thead class="table-dark">
    <tr>
      <th>Nome</th>
      <th>Significado</th>
      <th>Origem</th>
      <th>Motivo</th>
      <th>Pesquisas</th>
    </tr>
  </thead>
  <tbody>
    {% for row in resultados %}
    <tr>
      <td><strong>{{ row.nome }}</strong></td>
      <td>{{ row.significado }}</td>
      <td>{{ row.origem }}</td>
      <td>{{ row.motivo_escolha }}</td>
      <td>
        <span class="badge bg-success">{{ row.pesquisas }}</span>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% elif termo_pesquisado and termo_pesquisado|length >= 3 %}
<div class="alert alert-info mt-3">
  <strong>Nenhum resultado</strong> para "<em>{{ termo_pesquisado }}</em>".<br>
  <small>Tente outro nome ou <a href="{{ url_for('cadastrar') }}" class="alert-link">cadastre-o agora</a>!</small>
</div>
{% endif %}

{% endblock %}